name: Build and Test

on:
  push:
    branches:
      - '*'
  pull_request:

jobs:
  unit_tests:
    strategy:
      fail-fast: true
      matrix:
        php: ["latest", "5.6", "7.0", "7.1", "7.2", "7.3", "7.4", "8.0", "8.1"]
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v3

      - name: Build Image
        run: |
          docker build -f ${{ matrix.php }}/Dockerfile -t robbrazier/php:${{ matrix.php }} .
          docker images
          docker save robbrazier/php:${{ matrix.php }} > php-${{ matrix.php }}.tar